---
title: 在 React 和 Vue 中，数组中 key 的作用是什么？
category: 性能优化
date: 2025-07-09 21:30
difficulty: 中等
excerpt: 探讨了在 React 和 Vue 开发框架中，key 属性如何帮助优化虚拟 DOM 的 diff 算法以提升组件列表的渲染效率。
tags:
- React
- Vue
- 虚拟DOM
---
在 React 和 Vue 中，`key` 是用于辅助虚拟 DOM diff 算法优化性能的标识符，其核心作用包括：  
1.  **唯一性与追踪变化**：`key` 提供同级元素的唯一标识，帮助框架精确追踪列表项的增删改操作。例如，添加或移除元素时，`key` 可定位需更新的特定节点，避免全列表重渲染。  
2.  **优化 diff 算法效率**：  
    -   **React**：借助 `key` 比较新旧节点是否匹配。若同一 `key` 的节点存在，直接复用组件及关联状态（如本地 state），减少 DOM 操作，算法复杂度从 O(n³) 降至 O(n)。  
    -   **Vue**：默认采用就地更新策略（无 `key` 时按索引更新）。使用 `key` 后可准确识别新旧 VNodes，对符合的节点进行复用或位置移动，避免不必要的重建，提升响应速度。  
3.  **避免副作用**：  
    -   不使用 `key` 或误用 `index` 作为 key 时，可能导致状态混乱（如删除中间项目后，后续索引指向错误状态）。  
    -   若用随机数或时间戳作为 key，每次渲染创建新节点将频繁销毁旧组件，反而劣化性能（比不加 key 更差）。  

**使用最佳实践**：  
-   **唯一性**：使用数据项的唯一标识（如 `item.id`），而非数组索引或随机值。  
-   **稳定性**：确保同一个数据项每次渲染的 `key` 值不变，以维持组件状态的一致性。
